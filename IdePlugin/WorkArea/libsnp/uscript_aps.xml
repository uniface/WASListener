<?xml version='1.0' encoding='UTF-8' ?>
<!-- Created by Uniface - (C) Rocket Software B.V. All rights reserved -->
<!DOCTYPE UNIFACE PUBLIC "UNIFACE.DTD" "UNIFACE.DTD">
<UNIFACE release="10.4" repversion="8" xmlengine="2.0">
<TABLE>
<DSC name="ULIBSNP" model="DICT" system="S" pseudo ="73" level="1" noupdate="0"
 rbk="0" ffsql="0" transnr="0" segsize="0" ufocc="0" charset=".U">
<FLD name="UNAME" seqno="1" type="S" level="2" pack="0" scale="0" length="60"
 pointer="0" inum="1" ufocc="0" mandatory="yes" idxnum="1" idxsnr="101" />
<FLD name="UKVERSION" seqno="2" type="N" level="2" pack="10" scale="0" length="2"
 pointer="0" inum="1" ufocc="0" idxnum="2" idxsnr="1" />
<FLD name="UMVERSION" seqno="3" type="N" level="2" pack="10" scale="0" length="2"
 pointer="0" inum="1" ufocc="0" idxnum="3" idxsnr="1" />
<FLD name="UDESCR" seqno="4" type="S" level="2" pack="13" scale="0" length="256"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UTIMESTAMP" seqno="5" type="E" level="2" pack="0" scale="0" length="15"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UPURPOSE" seqno="6" type="S" level="2" pack="1" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UALT_NAME" seqno="7" type="S" level="2" pack="13" scale="0" length="128"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UKEYWORDS" seqno="8" type="S" level="2" pack="13" scale="0" length="256"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UWAORDER" seqno="9" type="N" level="2" pack="7" scale="0" length="5"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UCOMMENT" seqno="10" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",0,0,0,,1,0,1,\1D,0,0,0,," />
</DSC>
<OCC>
<DAT name="UNAME">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Library of trigger snippets for Application Shells</DAT>
<DAT name="UTIMESTAMP">2022-06-13T14:39:46.00</DAT>
<DAT name="UPURPOSE">N</DAT>
</OCC>
</TABLE>
<TABLE>
<DSC name="USNP" model="DICT" system="S" pseudo ="73" level="1" noupdate="0"
 rbk="0" ffsql="0" transnr="0" segsize="0" ufocc="0" charset=".U">
<FLD name="UTIMESTAMP" seqno="1" type="E" level="2" pack="0" scale="0" length="15"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UNAME" seqno="2" type="S" level="2" pack="0" scale="0" length="60"
 pointer="0" inum="2" ufocc="0" mandatory="yes" idxnum="1,4" idxsnr="103,1" />
<FLD name="USYNTAX" seqno="3" type="S" level="2" pack="0" scale="0" length="16"
 pointer="0" inum="2" ufocc="0" mandatory="yes" idxnum="1,4" idxsnr="102,2" />
<FLD name="ULIBRARY" seqno="4" type="S" level="2" pack="0" scale="0" length="60"
 pointer="0" inum="2" ufocc="0" mandatory="yes" idxnum="1,5" idxsnr="101,1" />
<FLD name="UCATEGORY" seqno="5" type="S" level="2" pack="0" scale="0" length="32"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UKVERSION" seqno="6" type="N" level="2" pack="10" scale="0" length="2"
 pointer="0" inum="1" ufocc="0" idxnum="2" idxsnr="1" />
<FLD name="UMVERSION" seqno="7" type="N" level="2" pack="10" scale="0" length="2"
 pointer="0" inum="1" ufocc="0" idxnum="3" idxsnr="1" />
<FLD name="UDESCR" seqno="8" type="S" level="2" pack="13" scale="0" length="256"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UPURPOSE" seqno="9" type="S" level="2" pack="1" scale="0" length="1"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UALT_NAME" seqno="10" type="S" level="2" pack="13" scale="0" length="128"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UKEYWORDS" seqno="11" type="S" level="2" pack="13" scale="0" length="256"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UWAORDER" seqno="12" type="N" level="2" pack="7" scale="0" length="5"
 pointer="0" inum="0" ufocc="0" />
<FLD name="UCOMMENT" seqno="13" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",0,0,0,,1,0,1,\1D,0,0,0,," />
<FLD name="UTEXT" seqno="14" type="S" level="2" pack="141" scale="0" length="0"
 pointer="0" inum="0" ufocc="0" varinfo=",1,0,2,\1F\C2,0,0,0,,0,0,0,," />
</DSC>
<OCC>
<DAT name="UNAME">APSTART</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired at application startup (Interactive)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;apstart&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger apstart
throws
; This is the first trigger fired at application startup
; Any command line arguments are available in $1, $2, etc

#if (&lt;DEVELOPMENT&gt; != TRUE)
  try
#endif

    ; Activate the first component of your application here, e.g....
    activate "MYFORM".exec()
    ; Include apstart to catch exceptions from non-modal forms
    apstart

#if (&lt;DEVELOPMENT&gt; != TRUE)
  catch
    ; Write uncaught exceptions to log file and throw generic exception
    call logException($procerrorcontext)
  endtry
#endif

  return 0

end
</DAT>
</OCC>
<OCC>
<DAT name="UNAME">APSTART_US</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired at application startup (USERVER)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;apstart&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger apstart
throws
; This trigger is fired at startup of the userver process; it is not fired by any client request.
; Use this trigger to setup state and singletons shared by all client requests.
; After execution of this trigger, the userver is ready to handle any client requests send by the urouter.

  ; Your code  here...

end
</DAT>
</OCC>
<OCC>
<DAT name="UNAME">KEYBOARDSWITCH</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired on macro "^SWITCH_KEY" (Interactive)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;keyboardSwitch&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger keyboardSwitch
throws
; Your VARIABLES block here (optional)...

  ; Your implementation here...

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">MENU</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired on macro "^MENU" (Interactive)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;menu&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger menu
throws
; Your VARIABLES block here (optional)...

  ; Your implementation here...

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">POSTREQUEST</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired at end of server request</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;postRequest&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger postRequest
throws
; Your VARIABLES block here (optional)...

  ; Your implementation here...

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">POSTREQUEST_US</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired at end of Web request  (USERVER)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;postRequest&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger postRequest
throws
; Your VARIABLES block here (optional)...

  ; Your implementation here...

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">PREREQUEST</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired at start of server request</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;preRequest&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger preRequest
throws
; For WRD-level user authentication for WEB applications, select one of the following methods:
; - Verify $user and $password against the operating system or a user administration system.
; - Verify $user using the LDAP connector.
; - Verify $user against an internal table of authorized users.

; Your VARIABLES block here (optional)...

  ; Insert your code...

  ; Return execution status:
  ;   return 0    ; return &gt;= 0 indicates successful execution -&gt; the requested component is activated
  ;   return -1   ; return &lt; 0 indicates an error during execution -&gt; the request is cancelled.
  ;   return -21  ; Specific error: Authorization failure.
  ; endif
  return 0

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">PREREQUEST_US</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired at start of Web request (USERVER)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;preRequest&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger preRequest
throws
; For WRD-level user authentication for WEB applications, select one of the following methods:
; - Verify $user and $password against the operating system or a user administration system.
; - Verify $user using the LDAP connector.
; - Verify $user against an internal table of authorized users.

; Your VARIABLES block here (optional)...

  ; Insert your code...

  ; Return execution status:
  ;   return 0    ; return &gt;= 0 indicates successful execution -&gt; the requested component is activated
  ;   return -1   ; return &lt; 0 indicates an error during execution -&gt; the request is cancelled.
  ;   return -21  ; Specific error: Authorization failure.
  ; endif
  return 0

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">RECEIVEMESSAGE</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired when postmessage is received (Interactive)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;receiveMessage&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger receiveMessage
throws
; A message arrrives here, when no component instance has received it.
; $result contains source indication:
;   "message" - trigger receiveMessage was fired by postmessage statement
;               $msgid contains the message id
;               $msgdata contains the message data
;               $msgsrc contains the message source
;   "Timeout" - trigger receiveMessage was fired by $TIMEOUT as configured in your assignment file

; Your VARIABLES block here (optional)...

  ;- Example:
  selectcase $uppercase($result)
  case "MESSAGE"
    ; Trigger fired by postmessage statement

    selectcase $uppercase($msgid)
    case "MSG1"
      ; Trigger fired by postmessage with message Id "MSG1"

      ; Your implementation here...

    case "MSG2"
      ; Trigger fired by: postmessage instanceName, "MSG2", ...

      ; Your implementation here...

    endselectcase

  case "TIMEOUT"
    ; Trigger fired by $TIMEOUT
    ; $TIMEOUT can be set in the [SETTINGS] section of your assignment file
    ; and generates a TIMEOUT message after an inactive period.

    ; Your implementation here...

  endselectcase

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">RECEIVEMESSAGE_US</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired when postmessage is received (USERVER)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;receiveMessage&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger receiveMessage
throws
; A message arrrives here, when no component instance has received it.
; $result contains source indication:
;   "message" - trigger receiveMessage was fired by postmessage statement
;               $msgid contains the message id
;               $msgdata contains the message data
;               $msgsrc contains the message source
;   "Timeout" - trigger receiveMessage was fired by $TIMEOUT as configured in your assignment file

; Your VARIABLES block here (optional)...

  ;- Example:
  selectcase $uppercase($result)
  case "MESSAGE"
    ; Trigger fired by postmessage statement

    selectcase $uppercase($msgid)
    case "MSG1"
      ; Trigger fired by postmessage with message Id "MSG1"

      ; Your implementation here...

    case "MSG2"
      ; Trigger fired by: postmessage instanceName, "MSG2", ...

      ; Your implementation here...

    endselectcase

  case "TIMEOUT"
    ; Trigger fired by $TIMEOUT
    ; $TIMEOUT can be set in the [SETTINGS] section of your assignment file
    ; and generates a TIMEOUT message after an inactive period.

    ; Your implementation here...

  endselectcase

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">USERKEY</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired on macro "^USER_KEY" (Interactive)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;trigger&lt;/x&gt; &lt;z&gt;userKey&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>trigger userKey
throws
; This trigger is used to define the processing associated with user-defined key sequences.
; These are defined in the keyboard translation table using the ^USER_KEY definition.
; The identification character for this user key sequence is available in $char.

variables
  string vKeySequence
  ; more variables here...
endvariables

  selectcase $char
  case "&lt;character1&gt;"
    vKeySequence = $result
    ; Your implementation here...

  case "&lt;character2&gt;"
    vKeySequence = $result
    ; Your implementation here...

  endselectcase

end</DAT>
</OCC>
<OCC>
<DAT name="UNAME">Z_LOGEXCEPTION</DAT>
<DAT name="USYNTAX">PROCSCRIPT</DAT>
<DAT name="ULIBRARY">USCRIPT_APS</DAT>
<DAT name="UKVERSION">7</DAT>
<DAT name="UMVERSION">2</DAT>
<DAT name="UDESCR" xml:space='preserve'>Fired on macro "^USER_KEY" (Interactive)</DAT>
<DAT name="UALT_NAME" xml:space='preserve'>&lt;t&gt;&lt;x&gt;entry&lt;/x&gt; &lt;z&gt;logException&lt;/z&gt;&lt;/t&gt;</DAT>
<DAT name="UTEXT" xml:space='preserve'>entry logException
throws
returns string  ; exception-list
params
  string pProcErrorContext: in
endparams
variables
  string vErrorId, vError
endvariables

  ; Generate an error Id for reference
  vErrorId = $uuid

  ; To avoid showing implementation details to the end-user, which could be abused by hackers,
  ; make the exception details available to a support team, for example by sending a mail or by writing to a redirected log file.
  ; As a simple example, we will write the exception details to the log file.
  ; Modify this code to suit your needs:
  filedump/append "An unexpected procerror terminated the application%%^", "procerror.log"
  filedump/append "ERRORID=%%(vErrorId)%%^", "procerror.log"
  filedump/append "DATETIME=%%($datim)%%^", "procerror.log"
  filedump/append "PROCERRORCONTEXT=%%(pProcErrorContext)%%^", "procerror.log"
  filedump/append "%%^", "procerror.log"

  ; Show a generic error message containing the error Id
  message/error "An unexpected procerror will terminate the application, contact your administrator.%%^Provide the following error Id for reference: %%(vErrorId)~Uncaught exception"

end
</DAT>
</OCC>
</TABLE>
</UNIFACE>
